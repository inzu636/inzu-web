<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dream Satta Result</title>
  <meta name="description" content="Live bazar result board — mobile-first neon UI. No login. Updated manually."/>

  <style>
    /* ====== Base / Mobile-first ====== */
    :root{
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      --bg: #ffffff;
      --card: #000;
      --muted: #6b7280;
      --accent: #4da3ff;
      --success: #ff8a3d;
    }
    *{box-sizing:border-box}
    html,body{height:100%;}
    body{
      margin:0;
      background: var(--bg);
      color:#111827;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:18px;
      font-size:16px;
      line-height:1.3;
    }

    /* Container */
    .wrap{max-width:980px;margin:0 auto;display:flex;flex-direction:column;gap:18px}

    /* Header / Logo */
    .header{display:flex;align-items:center;gap:12px;padding:12px;border-radius:12px;background:transparent;}
    .logo{
      width:56px;height:56px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:22px;
      background:linear-gradient(90deg,#111,#333);color:#fff;
    }
    .brand{display:flex;flex-direction:column;align-items:center}
    .brand .title{font-weight:900;letter-spacing:0.8px;font-size:22px;text-align:center;color:#000;}
    .brand .subtitle{font-size:13px;color:var(--muted);text-align:center;margin-top:2px;}

    /* Grid of bazars (mobile-first: column) */
    .bazars{display:flex;flex-direction:column;gap:12px}

    .bazar-card{
      padding:12px;border-radius:14px;background:var(--card); color: #fff;
      border:1px solid rgba(255,255,255,0.04); position:relative;overflow:hidden;display:flex;flex-direction:column;gap:12px;
      transform-origin:center;opacity:0;animation:fadeIn .4s ease forwards;
    }
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    .bazar-row{display:flex;justify-content:space-between;align-items:center}
    .bazar-name{font-weight:700;font-size:16px}
    .bazar-times{font-size:13px;color:var(--muted)}

    .timer{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;font-weight:700;background: transparent;padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);display:inline-block}
    .label{font-size:12px;color:var(--muted)}

    /* Result box */
    .result-wrap{display:flex;flex-direction:column;gap:8px;align-items:flex-start}
    .result-title{font-size:13px;color:var(--muted)}
    .result-box{
      min-width:120px;padding:12px 18px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:26px;letter-spacing:1px;
      background:#111;border:1px solid rgba(255,255,255,0.04);box-shadow: 0 8px 30px rgba(0,0,0,0.5);color:var(--accent);
      transition:transform .25s ease, box-shadow .25s ease;
    }
    .result-box.live{color:var(--success); animation:glowPulse 1.4s ease-in-out infinite}
    @keyframes glowPulse{0%{transform:scale(1)}50%{transform:scale(1.04)}100%{transform:scale(1)}}

    /* Instructions box */
    .instructions{padding:12px;border-radius:12px;background:#f3f4f6;border:1px solid #e5e7eb;color:var(--muted)}
    .instructions h3{margin:0 0 8px 0;color:var(--accent)}
    .instructions ul{margin:0;padding-left:18px}

    /* Footer */
    footer{padding:12px;border-radius:12px;text-align:center;color:var(--muted);font-size:13px}

    /* Admin panel styling */
    .admin-panel{padding:12px;border-radius:12px;background:#0b1020;color:#fff;border:1px solid rgba(255,255,255,0.04)}
    .admin-panel input[type="text"]{width:100%;padding:8px;border-radius:6px;border:1px solid #333;background:#0f1724;color:#fff;margin-top:6px}
    .admin-grid{display:grid;grid-template-columns:1fr 140px;gap:8px;align-items:center}

    @media(min-width:720px){
      .bazars{display:grid;grid-template-columns:repeat(2,1fr);gap:16px}
      body{padding:28px}
      .wrap{gap:22px}
    }
    @media(min-width:1100px){
      .bazars{grid-template-columns:repeat(3,1fr)}
    }

    .hidden{display:none}
  </style>

  <!-- PART 2 will go here (Firebase & Admin scripts) -->
</head>
<body>
  <h2 id="showResult">000</h2>
  <div class="wrap">
    <header class="header">
      <div class="logo" aria-hidden>⭐</div>
      <div class="brand">
        <div class="title">Dream Satta Result</div>
        <div class="subtitle">Live Bazar Results — No Login</div>
      </div>
    </header>

    <!-- Bazars list: cards are generated by JS -->
    <main class="bazars" id="bazars"></main>

    <section class="instructions">
      <h3>How this works</h3>
      <ul>
        <li>This website only displays results — no registration or login required.</li>
        <li>Results are stored in Firebase and updated via admin panel.</li>
        <li>Admin must use secret URL to unlock: <code>?admin=Sonu0786</code></li>
        <li>Timings shown are official bazar timings. Results reveal at opening time.</li>
      </ul>
    </section>

    <footer>
      <div>This website is only for result information. We are not connected to any betting or gambling activity.</div>
    </footer>

    <!-- Admin Panel (hidden by default) -->
    <section id="admin-panel" class="hidden">
      <div class="admin-panel">
        <h3 style="margin:0 0 8px 0;color:#9ae6ff">Admin Panel</h3>
        <p style="margin:0 0 8px 0;color:#cbd5e1">Enter admin key or open secret URL <code>?admin=Sonu0786</code></p>

        <div style="margin-bottom:10px;">
          <input type="password" id="adminKey" placeholder="Enter admin key (optional if using secret URL)">
          <button id="unlockBtn" style="margin-top:8px;padding:8px 12px;border-radius:6px;background:#4da3ff;border:none;color:#000;font-weight:700;cursor:pointer">Unlock</button>
        </div>

        <div id="adminEditor" class="hidden">
          <div id="adminFields"></div>
          <div style="margin-top:10px;">
            <button id="saveBtn" style="padding:10px 12px;border-radius:6px;background:#ff8a3d;border:none;color:#000;font-weight:700;cursor:pointer">Save Results</button>
            <button id="unlockUrlBtn" style="padding:10px 12px;border-radius:6px;background:#9ca3af;border:none;color:#000;margin-left:8px;cursor:pointer">Unlock (secret URL)</button>
          </div>
          <p id="adminNote" style="margin-top:8px;color:#9ca3af;font-size:13px"></p>
        </div>
      </div>
    </section>

  </div>

  <!-- PART 2 (Firebase + Admin JS) should be pasted next -->
  <!-- Firebase SDK (compat style) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

  <script>
  /***** PART 2: Firebase config + Admin handlers (DB lock, load fields, save) *****/

  // ---------- Firebase config (your values) ----------
  const firebaseConfig = {
    apiKey: "AIzaSyAbc6isx9WyzpEjNPm7LT1P6jN6BdNF-OQ",
    authDomain: "dream-satta-636.firebaseapp.com",
    databaseURL: "https://dream-satta-636-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "dream-satta-636",
    storageBucket: "dream-satta-636.firebasestorage.app",
    messagingSenderId: "788649199038",
    appId: "1:788649199038:web:1f266d2b115646ce1c25ef",
    measurementId: "G-07FDTYMZN4"
  };

  // Initialize
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Admin key for form (you can change)
  const ADMIN_KEY = "Sonu0786";

  // Helper: show/hide admin UI
  const adminPanel = document.getElementById('admin-panel');
  const adminEditor = document.getElementById('adminEditor');
  const adminFields = document.getElementById('adminFields');
  const adminNote = document.getElementById('adminNote');

  // Secret URL check: if ?admin=Sonu0786 present -> unhide and clear DB lock for admin
  (function(){
    try {
      const params = new URLSearchParams(location.search);
      const secret = params.get('admin');
      if (secret && secret === ADMIN_KEY) {
        // show admin panel
        adminPanel.classList.remove('hidden');
        adminEditor.classList.remove('hidden');
        adminNote.textContent = "Admin unlocked via secret URL. You can update results. (After save, results will LOCK until secret URL unlock again.)";
        // Clear DB-level lock (allow admin to update)
        db.ref('meta/locked').set(false).catch(()=>{});
        // load current DB values into fields (once they exist)
        setTimeout(()=>{ if(typeof loadAdminFields === 'function') loadAdminFields(); }, 200);
      }
    } catch(e) { console.warn(e) }
  })();

  // If user clicks Unlock button (adminKey input)
  document.getElementById('unlockBtn').addEventListener('click', ()=> {
    const key = document.getElementById('adminKey').value.trim();
    if (key === ADMIN_KEY) {
      adminPanel.classList.remove('hidden');
      adminEditor.classList.remove('hidden');
      adminNote.textContent = "Admin unlocked with key. (If DB lock is active, you may need to use secret URL to reset lock.)";
      loadAdminFields();
    } else {
      alert('Incorrect Admin Key');
    }
  });

  // Unlock via button (sets DB lock false) — useful if admin uses secret URL is not possible
  document.getElementById('unlockUrlBtn').addEventListener('click', ()=>{
    // to truly reset lock owner should use ?admin=Sonu0786, but allow button for convenience **only if admin is unlocked via key**
    const key = document.getElementById('adminKey').value.trim();
    if (key !== ADMIN_KEY) return alert('Enter admin key to use this.');
    db.ref('meta/locked').set(false).then(()=> {
      adminNote.textContent = "DB lock cleared. You can now save results.";
      alert('Unlocked for admin (DB flag cleared).');
    }).catch(err => { console.error(err); alert('Unlock failed'); });
  });

  // Load admin input fields from current DB values (populate inputs)
  async function loadAdminFields(){
    adminFields.innerHTML = 'Loading fields...';
    try {
      const snap = await db.ref('results').once('value');
      const data = snap.val() || {};
      adminFields.innerHTML = '';

      // use current BAZARS mapping (we'll have BAZARS array in Part 3)
      if(typeof BAZARS === 'undefined' || !Array.isArray(BAZARS)) {
        adminFields.innerHTML = '<div style="color:#fca5a5">BAZARS array not loaded yet — wait a second and press Load again.</div>';
        return;
      }

      BAZARS.forEach(b => {
        const val = (data[b.id] && data[b.id].result) ? data[b.id].result : '';
        const field = document.createElement('div');
        field.style.marginBottom = '8px';
        field.innerHTML = `
          <label style="display:block;color:#cbd5e1;margin-bottom:6px">${b.name}</label>
          <div class="admin-grid">
            <input type="text" id="edit-${b.id}" value="${val || ''}" placeholder="Enter ${b.name} result">
            <button style="padding:8px;border-radius:6px;background:#4da3ff;border:none;cursor:pointer" onclick="fillFromDB('${b.id}')">Refresh</button>
          </div>
        `;
        adminFields.appendChild(field);
      });

      adminFields.appendChild(document.createElement('br'));
      adminNote.textContent = "Loaded latest DB values. Edit and click Save Results.";
    } catch(err){
      console.error(err);
      adminFields.innerHTML = '<div style="color:#fca5a5">Failed to load fields from DB.</div>';
    }
  }

  // small helper exposed to refresh a single field from DB
  async function fillFromDB(bazarId){
    try {
      const snap = await db.ref('results/' + bazarId).once('value');
      const data = snap.val();
      if (data && data.result !== undefined) {
        const el = document.getElementById('edit-'+bazarId);
        if (el) el.value = data.result;
        alert('Refreshed field from DB');
      } else alert('No value in DB yet');
    } catch(e){ console.error(e); alert('Failed to refresh'); }
  }

  // Save results button: writes to /results and then sets meta.locked = true
  document.getElementById('saveBtn').addEventListener('click', async ()=> {
    try {
      // check DB lock
      const lockSnap = await db.ref('meta/locked').once('value');
      const locked = lockSnap.exists() ? !!lockSnap.val() : false;
      if (locked) {
        alert('Results are LOCKED. Only admin can unlock using secret URL (?admin=Sonu0786).');
        return;
      }

      // prepare updates
      const updates = {};
      BAZARS.forEach(b => {
        const val = document.getElementById('edit-'+b.id).value.trim();
        updates['results/' + b.id] = { result: val || '--', updatedAt: new Date().toISOString() };
      });

      // write atomically
      await db.ref().update(updates);
      // set DB lock
      await db.ref('meta/locked').set(true);
      adminNote.textContent = 'Results saved and DB locked. Admin must open secret URL to unlock for next update.';
      alert('Results updated and locked successfully.');
    } catch(err) {
      console.error(err);
      alert('Save failed: ' + (err.message || 'unknown'));
    }
  });

  // expose some functions globally for inline onclick use
  window.loadAdminFields = loadAdminFields;
  window.fillFromDB = fillFromDB;

  </script>
  <script>
  /***** PART 3: BAZARS array, build cards, timers and DB listeners *****/

  // ========= CONFIG - BAZARS =========
  const BAZARS = [
    { id:'delhi', name:'Delhi Bazar', open:'10:00 AM', close:'11:00 AM' },
    { id:'kolkata', name:'Kolkata Bazar', open:'11:00 AM', close:'12:00 PM' },
    { id:'mumbai', name:'Mumbai Bazar', open:'1:00 PM', close:'2:00 PM' },
    { id:'ghaziabad', name:'Ghaziabad Bazar', open:'2:00 PM', close:'3:00 PM' },
    { id:'gali', name:'Gali Bazar', open:'3:00 PM', close:'4:00 PM' },
    { id:'disawar', name:'Disawar Bazar', open:'4:00 PM', close:'5:00 PM' },
    { id:'shreeganesh', name:'ShreeGanesh Bazar', open:'6:00 PM', close:'7:00 PM' },
    { id:'faridabad', name:'Faridabad Bazar', open:'8:00 PM', close:'9:00 PM' },
    { id:'rajasthan', name:'Rajasthan Bazar', open:'9:00 PM', close:'10:00 PM' },
    { id:'lucknow', name:'Lucknow Bazar', open:'10:00 PM', close:'11:00 PM' }
  ];

  // Build cards in DOM
  const bazarsContainer = document.getElementById('bazars');
  BAZARS.forEach((bazar, idx) => {
    const card = document.createElement('article');
    card.className = 'bazar-card';
    card.id = `card-${bazar.id}`;
    card.innerHTML = `
      <div class="bazar-content">
        <div class="bazar-row">
          <div>
            <div class="bazar-name">${bazar.name}</div>
            <div class="bazar-times">${bazar.open} — ${bazar.close}</div>
          </div>
          <div class="meta">
            <div class="label">Opens In</div>
            <div class="timer" id="timer-${bazar.id}">--:--:--</div>
          </div>
        </div>

        <div class="result-wrap">
          <div class="result-title" id="status-${bazar.id}">Waiting...</div>
          <div class="result-box" id="result-${bazar.id}" data-result="--"> -- </div>
        </div>
      </div>
    `;
    bazarsContainer.appendChild(card);

    // attach DB listener for this bazar result to keep data-result up-to-date
    db.ref('results/' + bazar.id).on('value', snapshot => {
      const data = snapshot.val();
      const resultEl = document.getElementById('result-' + bazar.id);
      if (!resultEl) return;
      const newVal = (data && data.result) ? data.result : '--';
      resultEl.setAttribute('data-result', newVal);
      // If currently live, show result text immediately
      const statusEl = document.getElementById('status-' + bazar.id);
      if (statusEl && statusEl.textContent === 'Live Result') {
        resultEl.textContent = newVal;
        resultEl.classList.add('live');
      } else {
        // otherwise show placeholder or last value (but not glowing)
        resultEl.textContent = newVal;
        resultEl.classList.remove('live');
      }
    });

    // start timer for the card
    setupTimerFor(bazar);
  });

  // ========= Utility: parse times like '10:00 AM' -> returns Date for next occurrence =========
  function parseNextOccurrence(timeStr){
    const now = new Date();
    const [time, ampm] = timeStr.split(' ');
    let [h, m] = time.split(':').map(Number);
    if (ampm.toUpperCase() === 'PM' && h !== 12) h += 12;
    if (ampm.toUpperCase() === 'AM' && h === 12) h = 0;
    const candidate = new Date(now.getFullYear(), now.getMonth(), now.getDate(), h, m, 0, 0);
    if (candidate.getTime() <= now.getTime() - 1000) candidate.setDate(candidate.getDate() + 1);
    return candidate;
  }

  function formatTimePart(n){ return String(n).padStart(2,'0'); }

  // Timer logic (independent per bazar)
  function setupTimerFor(bazar) {
    const timerEl = document.getElementById(`timer-${bazar.id}`);
    const statusEl = document.getElementById(`status-${bazar.id}`);
    const resultEl = document.getElementById(`result-${bazar.id}`);
    let target = parseNextOccurrence(bazar.open);

    // initial render
    updateTimer();

    const intervalId = setInterval(updateTimer, 1000);

    function updateTimer(){
      const now = new Date();
      let diff = Math.max(0, target.getTime() - now.getTime());
      if (diff <= 0) {
        // show live result
        statusEl.textContent = 'Live Result';
        resultEl.classList.add('live');
        const manual = resultEl.getAttribute('data-result') || '--';
        resultEl.textContent = manual;
        timerEl.textContent = '00:00:00';

        // schedule next opening (next day same time)
        target.setDate(target.getDate() + 1);
      } else {
        statusEl.textContent = 'Opens In';
        resultEl.classList.remove('live');
        const hours = Math.floor(diff / 3600000);
        diff -= hours * 3600000;
        const mins = Math.floor(diff / 60000);
        diff -= mins * 60000;
        const secs = Math.floor(diff / 1000);
        timerEl.textContent = `${formatTimePart(hours)}:${formatTimePart(mins)}:${formatTimePart(secs)}`;
      }
    }
  }

  // Optional: show DB lock status to admin whenever it changes
  db.ref('meta/locked').on('value', snap => {
    const locked = snap.exists() ? !!snap.val() : false;
    if (adminNote) {
      adminNote.textContent = locked ? 'DB is LOCKED. Admin must use secret URL to unlock.' : 'DB is UNLOCKED. Admin may save results.';
    }
  });
  <script>
fetch("result.json")
  .then(res => res.json())
  .then(data => {
    document.getElementById("showResult").innerText = data.result;
  });
  </script>

  </script>
</body>
</html>

